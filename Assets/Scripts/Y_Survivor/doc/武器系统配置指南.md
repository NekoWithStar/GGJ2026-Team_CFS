# æ­¦å™¨ç³»ç»Ÿé…ç½®æŒ‡å—

> ğŸ“Œ **æ–°åŠŸèƒ½**ï¼šå±æ€§å¡ç³»ç»Ÿå·²é›†æˆï¼æŸ¥çœ‹ [å±æ€§ç³»ç»Ÿåœºæ™¯é…ç½®æŒ‡å—.md](./å±æ€§ç³»ç»Ÿåœºæ™¯é…ç½®æŒ‡å—.md) äº†è§£å¦‚ä½•åœ¨åœºæ™¯ä¸­é…ç½®åŠ¨æ€å±æ€§ç®¡ç†ã€‚

## ç›®å½•
1. [åŸºç¡€æ¦‚å¿µ](#åŸºç¡€æ¦‚å¿µ)
2. [Weapon ScriptableObject å±æ€§](#weapon-scriptableobject-å±æ€§)
3. [å¼€ç«æ¨¡å¼](#å¼€ç«æ¨¡å¼)
4. [FirePattern å‘å°„æ¨¡å¼](#firepattern-å‘å°„æ¨¡å¼)
5. [é…ç½®ç¤ºä¾‹](#é…ç½®ç¤ºä¾‹)
6. [å±æ€§å¡ç³»ç»Ÿ](#å±æ€§å¡ç³»ç»Ÿ-propertycard-system)
7. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## åŸºç¡€æ¦‚å¿µ

### æ ¸å¿ƒç»„ä»¶

- **Weapon.cs** - ScriptableObjectï¼Œå®šä¹‰æ­¦å™¨çš„æ‰€æœ‰å±æ€§
- **WeaponControl.cs** - MonoBehaviourï¼Œæ­¦å™¨çš„è¿è¡Œæ—¶æ§åˆ¶å™¨ï¼Œå¤„ç†å¼€ç«é€»è¾‘
- **FirePattern.cs** - ScriptableObjectï¼Œå®šä¹‰æŒç»­è‡ªåŠ¨å¼€ç«æ­¦å™¨çš„å‘å°„æ¨¡å¼
- **PlayerControl.cs** - ç©å®¶è¾“å…¥å’Œæ­¦å™¨è£…å¤‡ç®¡ç†

### æ­¦å™¨å·¥ä½œæµç¨‹

```
ç©å®¶è£…å¤‡æ­¦å™¨ â†’ è®¾ç½® WeaponControl.weaponData â†’ æ ¹æ®å¼€ç«æ¨¡å¼å¤„ç†è¾“å…¥ â†’ æŒ‰ç…§ FirePattern æˆ–æ”»å‡»é€Ÿç‡å‘å°„
```

### ä¸‰ç§æ”»å‡»æ¨¡å¼

1. **æŒç»­è‡ªåŠ¨å¼€ç«**ï¼ˆ`continuousAutoFire = true`ï¼‰
   - è£…å¤‡åæ— éœ€ç©å®¶è¾“å…¥
   - æŒ‰ç…§ `FirePattern` è‡ªåŠ¨å°„å‡»
   - æŒç»­æ—¶é—´ç”± `continuousFireDuration` æ§åˆ¶
   - å†·å´æ—¶é—´ç”± `cooldown` æ§åˆ¶

2. **è“„åŠ›æ”»å‡»**ï¼ˆ`requiresCharging = true`ï¼‰
   - ç©å®¶æŒ‰ä¸‹å¼€ç«é”®åå¼€å§‹è“„åŠ›
   - è“„åŠ›å®Œæˆåè‡ªåŠ¨è¿›å…¥è¿ç»­å¼€ç«çŠ¶æ€
   - é€‚ç”¨äºæ‰€æœ‰æ­¦å™¨ç±»å‹

3. **è¿ç»­å¼€ç«**ï¼ˆæ ‡å‡†æ¨¡å¼ï¼‰
   - ç©å®¶æŒ‰ä½å¼€ç«é”®æŒç»­å°„å‡»
   - æŒ‰ç…§ `attackRate` æ§åˆ¶å°„é€Ÿ
   - æœ€å¸¸è§çš„æ”»å‡»æ–¹å¼

---

## Weapon ScriptableObject å±æ€§

### åŸºç¡€ä¿¡æ¯

| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `weaponType` | WEAPON_TYPE | è¿‘æˆ˜(Melee) / è¿œç¨‹(Ranged) |
| `weaponName` | string | æ­¦å™¨åç§° |
| `weaponIcon` | Image | æ­¦å™¨å›¾æ ‡ï¼ˆUIæ˜¾ç¤ºï¼‰ |

### ä¼¤å®³é…ç½®

| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `damage` | int | å•æ¬¡æ”»å‡»ä¼¤å®³å€¼ |
| `range` | float | è¿‘æˆ˜åˆ¤å®šåŠå¾„ / è¿œç¨‹æœ‰æ•ˆèŒƒå›´ |

### å¼€ç«æ¨¡å¼

| å±æ€§ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `continuousAutoFire` | bool | false | æ˜¯å¦ä¸ºæŒç»­è‡ªåŠ¨å¼€ç«æ­¦å™¨ |
| `continuousFireDuration` | float | 5f | æŒç»­è‡ªåŠ¨å¼€ç«æŒç»­æ—¶é—´ï¼ˆç§’ï¼‰ |
| `firePattern` | FirePattern | null | æŒç»­è‡ªåŠ¨å¼€ç«çš„å‘å°„æ¨¡å¼è„šæœ¬ |
| `requiresCharging` | bool | false | æ˜¯å¦éœ€è¦è“„åŠ› |
| `chargingTime` | float | 0.2f | è“„åŠ›æ‰€éœ€æ—¶é—´ï¼ˆç§’ï¼‰ |

### æ—¶é—´è®¾ç½®

| å±æ€§ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `cooldown` | float | 0.5f | å†·å´æ—¶é—´ï¼ˆç§’ï¼‰ã€‚è‹¥æ— éœ€å†·å´å¯è®¾ä¸º 0 |
| `attackRate` | float | 1f | æ”»å‡»é€Ÿç‡ï¼ˆæ¯ç§’æ”»å‡»æ¬¡æ•°ï¼‰ |

### éŸ³æ•ˆ

| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `fireSound` | AudioClip | å¼€ç«æ—¶æ’­æ”¾çš„éŸ³æ•ˆ |
| `chargingSound` | AudioClip | è“„åŠ›æ—¶æ’­æ”¾çš„éŸ³æ•ˆ |
| `continuousFireEndSound` | AudioClip | æŒç»­å¼€ç«ç»“æŸæ—¶çš„éŸ³æ•ˆï¼ˆå¦‚è¿‡çƒ­éŸ³ï¼‰ |
| `cooldownEndSound` | AudioClip | å†·å´ç»“æŸæ—¶çš„éŸ³æ•ˆ |

### è¿œç¨‹ä¸“ç”¨

| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `projectilePrefab` | GameObject | å­å¼¹é¢„åˆ¶ä½“ |
| `projectileSpeed` | float | å­å¼¹é€Ÿåº¦ |

### é¢„åˆ¶ä½“æŒ‚è½½

| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `weaponPrefab` | GameObject | æ­¦å™¨å¤–è§‚é¢„åˆ¶ä½“ï¼ˆå¯é€‰ï¼‰ |

---

## å‚æ•°ä¼˜å…ˆçº§ä¸èŒè´£åˆ’åˆ†

ä¸ºç¡®ä¿ç³»ç»Ÿæ¸…æ™°å¯ç»´æŠ¤ï¼Œå„å±‚çº§å‚æ•°æœ‰æ˜ç¡®çš„èŒè´£è¾¹ç•Œï¼š

### ğŸ“‹ Weapon å±‚çº§ï¼ˆæ—¶é—´ä¸ä¼¤å®³ï¼‰
- **èŒè´£**ï¼šæ§åˆ¶æ­¦å™¨çš„æ ¸å¿ƒæ•°å€¼å’Œæ—¶é—´å‚æ•°
- **å‚æ•°**ï¼š`attackRate`, `cooldown`, `continuousFireDuration`, `damage`, `range`
- **è§„åˆ™**ï¼šæ‰€æœ‰æ—¶é—´æ§åˆ¶ç»Ÿä¸€åœ¨æ­¤å±‚çº§ï¼ŒFirePattern ä¸åº”æ¶‰åŠæ—¶é—´

### ğŸ¯ FirePattern åŸºç±»ï¼ˆå‘å°„å¸ƒå±€ï¼‰
- **èŒè´£**ï¼šå®šä¹‰å‘å°„çš„æ•°é‡å’Œå¸ƒå±€æ–¹å¼
- **å‚æ•°**ï¼š`shotsPerCycle`, `bulletsPerShot`, `multiShotPattern`, `bulletSpreadAngle`
- **è§„åˆ™**ï¼šåªæè¿°"å‘ä»€ä¹ˆã€æ€ä¹ˆæ’åˆ—"ï¼Œä¸æ§åˆ¶"ä½•æ—¶å‘"

### âœ¨ FirePattern å­ç±»ï¼ˆæ•ˆæœå‚æ•°ï¼‰
- **èŒè´£**ï¼šå®ç°ç‰¹å®šå‘å°„æ¨¡å¼çš„è§†è§‰æ•ˆæœ
- **å‚æ•°**ï¼šå¦‚ `rotationSpeed`, `waveAmplitude`, `spreadMode` ç­‰
- **è§„åˆ™**ï¼šåªå½±å“æ–¹å‘å’Œä½ç½®è®¡ç®—ï¼Œä¸ä¿®æ”¹åŸºç±»çš„æ•°é‡å‚æ•°

**âš ï¸ é‡è¦çº¦å®š**ï¼š
- FirePattern å­ç±»çš„ `OnFireStart()` ä¸åº”ä¿®æ”¹ `shotsPerCycle`, `bulletsPerShot`, `multiShotPattern`
- æ‰€æœ‰å‘å°„é—´éš”ç”± `Weapon.attackRate` ç»Ÿä¸€æ§åˆ¶ï¼ˆé—´éš” = 1 / attackRateï¼‰
- å¤šå‘å­å¼¹æ•°é‡ç»Ÿä¸€ä½¿ç”¨ `bulletsPerShot`ï¼Œä¸åº”åˆ›å»ºé‡å¤å‚æ•°ï¼ˆå¦‚ ~~pelletsPerShot~~, ~~spiralCount~~ï¼‰

---

## å¼€ç«æ¨¡å¼

### æ¨¡å¼å¯¹æ¯”

| åŠŸèƒ½ | æŒç»­è‡ªåŠ¨å¼€ç« | è“„åŠ› | è¿ç»­å¼€ç« |
|------|-------------|------|---------|
| éœ€è¦ç©å®¶æŒ‰é”® | âŒ | âœ… | âœ… |
| è‡ªåŠ¨æŒç»­å°„å‡» | âœ… | âŒ | âœ… |
| æ”¯æŒè¿‘æˆ˜ | âœ… | âœ… | âœ… |
| æ”¯æŒè¿œç¨‹ | âœ… | âœ… | âœ… |
| å¯é…åˆ FirePattern | âœ… | âŒ | âŒ |

### æŒç»­è‡ªåŠ¨å¼€ç«å·¥ä½œæµç¨‹

```
è£…å¤‡ â†’ ç«‹å³è¿›å…¥ContinuousFiringçŠ¶æ€ â†’ æŒ‰FirePatternå‘å°„
       â†“
æŒç»­æ—¶é—´ç»“æŸ â†’ è¿›å…¥CooldownçŠ¶æ€ â†’ ç­‰å¾…cooldownç§’
       â†“
å†·å´å®Œæˆ â†’ å›åˆ°IdleçŠ¶æ€ â†’ é‡æ–°å¼€å§‹æŒç»­å¼€ç«
```

**çŠ¶æ€æ—¶é—´è¡¨ï¼š**
- æŒç»­å¼€ç«é˜¶æ®µï¼š`continuousFireDuration` ç§’
- å†·å´é˜¶æ®µï¼š`cooldown` ç§’
- æ€»å¾ªç¯å‘¨æœŸ = `continuousFireDuration` + `cooldown`

### è“„åŠ›å·¥ä½œæµç¨‹

```
ç©å®¶æŒ‰é”® â†’ ChargingçŠ¶æ€ â†’ è“„åŠ›ä¸­ï¼ˆplayChargingSoundï¼‰
       â†“
è“„åŠ›å®Œæˆï¼ˆchargingTimeç§’åï¼‰â†’ FiringçŠ¶æ€ â†’ è¿›å…¥è¿ç»­å¼€ç«
       â†“
ç©å®¶æ¾é”® â†’ åœæ­¢å¼€ç« â†’ å›åˆ°IdleçŠ¶æ€
```

### è¿ç»­å¼€ç«å·¥ä½œæµç¨‹

```
ç©å®¶æŒ‰é”® â†’ FiringçŠ¶æ€ â†’ æŒ‰attackRateæŒç»­å‘å°„
       â†“
ç©å®¶æ¾é”® â†’ åœæ­¢å¼€ç« â†’ å›åˆ°IdleçŠ¶æ€
```

---

## FirePattern å‘å°„æ¨¡å¼

### å†…ç½®æ¨¡å¼

#### 1. CircleFirePatternï¼ˆç¯å½¢ï¼‰
- **ç”¨é€”**ï¼šå…¨å‘å‡åŒ€å‘å°„
- **ä¸»è¦å‚æ•°**ï¼š
  - `startAngleOffset` - èµ·å§‹è§’åº¦åç§»
  - `clockwise` - æ˜¯å¦é¡ºæ—¶é’ˆ
  - `rotateOverTime` - æ˜¯å¦éšæ—¶é—´æ—‹è½¬
  - `rotationSpeed` - æ—‹è½¬é€Ÿåº¦

**åœºæ™¯ç¤ºä¾‹**ï¼šæ—‹è½¬æ¿€å…‰ã€å…¨å‘ç«ç„°

#### 2. FanFirePatternï¼ˆæ‰‡å½¢ï¼‰
- **ç”¨é€”**ï¼šå‰æ–¹æ‰‡å½¢åŒºåŸŸå‘å°„
- **ä¸»è¦å‚æ•°**ï¼š
  - `spreadAngle` - æ‰‡å½¢è§’åº¦
  - `useWeaponForward` - ä½¿ç”¨æ­¦å™¨æœå‘
  - `oscillate` - æ˜¯å¦æ‘†åŠ¨æ‰«å°„
  - `oscillationPeriod` - æ‘†åŠ¨å‘¨æœŸ

**åœºæ™¯ç¤ºä¾‹**ï¼šéœ°å¼¹æªã€ç«ç„°å–·æªã€æ¿€å…‰ç‚®

#### 3. SpiralFirePatternï¼ˆèºæ—‹ï¼‰
- **ç”¨é€”**ï¼šèºæ—‹çŠ¶å‘å°„ï¼Œå¯åˆ›å»ºå¤šé‡èºæ—‹
- **ä¸»è¦å‚æ•°**ï¼š
  - `anglePerShot` - æ¯å‘çš„è§’åº¦å¢é‡
  - `radiusGrowth` - åŠå¾„å¢é•¿é€Ÿåº¦
  - `maxRadius` - æœ€å¤§åŠå¾„é™åˆ¶
  - `bulletsPerShot` - èºæ—‹æ•°é‡ï¼ˆ1=å•èºæ—‹ï¼Œ2=åŒèºæ—‹ï¼Œ3=ä¸‰èºæ—‹ï¼‰

**åœºæ™¯ç¤ºä¾‹**ï¼šåŒèºæ—‹æ¿€å…‰ã€ä¸‰é‡èºæ—‹ã€æ¶¡è½®

#### 4. ShotgunFirePatternï¼ˆæ•£å¼¹ï¼‰
- **ç”¨é€”**ï¼šä¸€æ¬¡å‘å°„å¤šä¸ªå¼¹ä¸¸
- **ä¸»è¦å‚æ•°**ï¼š
  - `bulletsPerShot` - æ¯å‘å¼¹ä¸¸æ•°é‡ï¼ˆä½¿ç”¨åŸºç±»å‚æ•°ï¼‰
  - `shotgunSpread` - æ•£å°„è§’åº¦
  - `spreadMode` - æ•£å°„æ¨¡å¼ï¼ˆRandom/Uniform/Coneï¼‰

**åœºæ™¯ç¤ºä¾‹**ï¼šéœ°å¼¹æªã€æ•£å¼¹ç‚®

#### 5. WaveFirePatternï¼ˆæ³¢æµªï¼‰
- **ç”¨é€”**ï¼šäº¤æ›¿æ‘†åŠ¨å‘å°„
- **ä¸»è¦å‚æ•°**ï¼š
  - `waveAmplitude` - æ³¢æµªå¹…åº¦
  - `waveFrequency` - æ³¢æµªé¢‘ç‡
  - `waveType` - æ³¢å½¢ï¼ˆSine/Triangle/Squareï¼‰

**åœºæ™¯ç¤ºä¾‹**ï¼šæ³¢æµªæ¿€å…‰ã€äº¤æ›¿ç«ç„°

### å¤šå‘åŒæ—¶å‘å°„

æ‰€æœ‰ FirePattern éƒ½æ”¯æŒé€šè¿‡ä»¥ä¸‹å±æ€§é…ç½®ä¸€æ¬¡å‘å°„å¤šä¸ªå­å¼¹ï¼š

| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `bulletsPerShot` | int | å•æ¬¡å‘å°„å­å¼¹æ•°é‡ |
| `bulletSpreadAngle` | float | å¤šå‘å­å¼¹é—´è·è§’åº¦ |
| `multiShotPattern` | enum | æ’åˆ—æ–¹å¼ |

**æ’åˆ—æ–¹å¼ï¼š**
- `Spread` - æ‰©æ•£ï¼šä»¥ä¸»æ–¹å‘ä¸ºä¸­å¿ƒå‘ä¸¤ä¾§æ‰©æ•£
- `Cross` - åå­—ï¼šä¸Šä¸‹å·¦å³å››æ–¹å‘
- `Circle` - ç¯å½¢ï¼š360åº¦å‡åŒ€åˆ†å¸ƒ
- `Line` - ç›´çº¿ï¼šæ²¿ä¸»æ–¹å‘æ’æˆä¸€çº¿
- `Custom` - è‡ªå®šä¹‰ï¼šç”±å­ç±»å®ç°

---

## é…ç½®ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šå•å‘è¿ç»­æ‰‹æª

```
åŸºç¡€è®¾ç½®:
  weaponType = Ranged
  weaponName = "Hand Gun"
  damage = 15

å¼€ç«æ¨¡å¼:
  continuousAutoFire = false
  requiresCharging = false

æ—¶é—´è®¾ç½®:
  cooldown = 0.1f  (æ¯ç§’10å‘)

è¿œç¨‹é…ç½®:
  projectileSpeed = 20f
```

### ç¤ºä¾‹2ï¼šæ•£å¼¹æªï¼ˆè¿ç»­å¼€ç«ï¼Œæ¯å‘8ä¸ªå¼¹ä¸¸ï¼‰

```
åŸºç¡€è®¾ç½®:
  weaponType = Ranged
  weaponName = "Shotgun"
  damage = 40

å¼€ç«æ¨¡å¼:
  continuousAutoFire = false
  requiresCharging = true
  chargingTime = 0.5f

æ—¶é—´è®¾ç½®:
  cooldown = 1.5f

FirePattern:
  ä½¿ç”¨ ShotgunFirePattern
  åŸºç±»è®¾ç½®:
  - shotsPerCycle = 1  (æ•£å¼¹æªé€šå¸¸åªå‘å°„ä¸€æ¬¡)
  - bulletsPerShot = 8  (8ä¸ªå¼¹ä¸¸)
  - multiShotPattern = Custom
  æ•£å¼¹å‚æ•°:
  - shotgunSpread = 45
  - spreadMode = Random

è¿œç¨‹é…ç½®:
  projectileSpeed = 15f
```

### ç¤ºä¾‹3ï¼šæŒç»­è‡ªåŠ¨æ¿€å…‰

```
åŸºç¡€è®¾ç½®:
  weaponType = Ranged
  weaponName = "Laser Beam"
  damage = 8

å¼€ç«æ¨¡å¼:
  continuousAutoFire = true
  continuousFireDuration = 3f

æ—¶é—´è®¾ç½®:
  cooldown = 2f
  attackRate = 8  (æ¯ç§’8å‘)

FirePattern:
  ä½¿ç”¨ CircleFirePattern
  åŸºç±»è®¾ç½®:
  - shotsPerCycle = 10
  - bulletsPerShot = 1
  ç¯å½¢å‚æ•°:
  - startAngleOffset = 0
  - clockwise = true
  - rotateOverTime = true
  - rotationSpeed = 90

è¿œç¨‹é…ç½®:
  projectileSpeed = 25f
```

### ç¤ºä¾‹4ï¼šè“„åŠ›å¼“ç®­

```
åŸºç¡€è®¾ç½®:
  weaponType = Ranged
  weaponName = "Charge Bow"
  damage = 50

å¼€ç«æ¨¡å¼:
  continuousAutoFire = false
  requiresCharging = true
  chargingTime = 1.5f

æ—¶é—´è®¾ç½®:
  cooldown = 0.5f

è¿œç¨‹é…ç½®:
  projectileSpeed = 30f
```

### ç¤ºä¾‹5ï¼šæ—‹è½¬è¿‘æˆ˜æ­¦å™¨

```
åŸºç¡€è®¾ç½®:
  weaponType = Melee
  weaponName = "Spinning Blade"
  damage = 20
  range = 2.5f

å¼€ç«æ¨¡å¼:
  continuousAutoFire = true
  continuousFireDuration = 2f

æ—¶é—´è®¾ç½®:
  cooldown = 1f
  attackRate = 3

FirePattern:
  ä½¿ç”¨ CircleFirePattern
  åŸºç±»è®¾ç½®:
  - shotsPerCycle = 12
  - bulletsPerShot = 1
  ç¯å½¢å‚æ•°:
  - rotateOverTime = true
  - rotationSpeed = 180
```

### ç¤ºä¾‹6ï¼šåŒèºæ—‹æ¿€å…‰

```
åŸºç¡€è®¾ç½®:
  weaponType = Ranged
  weaponName = "Twin Spiral Laser"
  damage = 12

å¼€ç«æ¨¡å¼:
  continuousAutoFire = true
  continuousFireDuration = 4f

æ—¶é—´è®¾ç½®:
  cooldown = 1.5f
  attackRate = 5

FirePattern:
  ä½¿ç”¨ SpiralFirePattern
  åŸºç±»è®¾ç½®:
  - shotsPerCycle = 18  (å®Œæ•´èºæ—‹ä¸€åœˆ)
  - bulletsPerShot = 2  (åŒèºæ—‹)
  - multiShotPattern = Custom
  èºæ—‹å‚æ•°:
  - anglePerShot = 20
  - radiusGrowth = 0.15
  - clockwise = true
```

---

## å¸¸è§é—®é¢˜

### Q1ï¼šå¦‚ä½•è®©æ­¦å™¨å‘å°„æ—¶ä¸éœ€è¦ç©å®¶æŒ‰é”®ï¼Ÿ
**Aï¼š** è®¾ç½® `continuousAutoFire = true`ï¼Œæ­¦å™¨ä¼šè‡ªåŠ¨å¼€å§‹æŒç»­å¼€ç«ã€‚é…åˆ `FirePattern` å¯ä»¥å®ç°å¤æ‚çš„å‘å°„æ¨¡å¼ã€‚

### Q2ï¼šå¦‚ä½•æ§åˆ¶è¿ç»­å¼€ç«çš„å°„é€Ÿï¼Ÿ
**Aï¼š** è°ƒæ•´ `attackRate` å€¼ï¼ˆæ¯ç§’å‘å°„æ¬¡æ•°ï¼‰ï¼Œæ•°å€¼è¶Šå¤§å°„é€Ÿè¶Šå¿«ã€‚ä¾‹å¦‚ `attackRate = 2` è¡¨ç¤ºæ¯ç§’å‘å°„ 2 æ¬¡ã€‚

### Q3ï¼šè“„åŠ›åå¦‚ä½•è‡ªåŠ¨è¿›å…¥è¿ç»­å¼€ç«ï¼Ÿ
**Aï¼š** è®¾ç½® `requiresCharging = true`ï¼Œè“„åŠ›å®Œæˆåä¼šè‡ªåŠ¨è¿›å…¥ `Firing` çŠ¶æ€è¿›è¡Œè¿ç»­å¼€ç«ã€‚ç©å®¶æ¾å¼€æŒ‰é”®ååœæ­¢ã€‚

### Q4ï¼šå¦‚ä½•å®ç°ä¸€æ¬¡å‘å°„å¤šä¸ªå­å¼¹ï¼Ÿ
**Aï¼š** 
1. è®¾ç½® FirePattern çš„ `bulletsPerShot > 1`
2. é€‰æ‹©åˆé€‚çš„ `multiShotPattern`ï¼ˆSpread/Cross/Circle/Line/Customï¼‰
3. è®¾ç½® `bulletSpreadAngle` æ§åˆ¶å­å¼¹é—´è·

### Q5ï¼šæŒç»­è‡ªåŠ¨å¼€ç«æ­¦å™¨çš„éŸ³æ•ˆä½•æ—¶æ’­æ”¾ï¼Ÿ
**Aï¼š**
- `fireSound` - æ¯æ¬¡å‘å°„æ—¶æ’­æ”¾ï¼ˆé€šè¿‡ `PlayOneShot`ï¼‰
- `chargingSound` - è“„åŠ›æ—¶å¾ªç¯æ’­æ”¾ï¼ˆè‹¥æœ‰è“„åŠ›ï¼‰
- `continuousFireEndSound` - æŒç»­å¼€ç«ç»“æŸæ—¶æ’­æ”¾
- `cooldownEndSound` - å†·å´å®Œæˆæ—¶æ’­æ”¾

### Q6ï¼šå¦‚ä½•åˆ›å»ºè‡ªå®šä¹‰ FirePatternï¼Ÿ
**Aï¼š** 
1. ç»§æ‰¿ `FirePattern` ç±»
2. å®ç° `GetFireDirection()` æ–¹æ³•å®šä¹‰å‘å°„æ–¹å‘
3. å¯é€‰å®ç° `GetPositionOffset()` å®šä¹‰ä½ç½®åç§»
4. å¯é€‰å®ç° `GetCustomMultiShotDirections()` å®šä¹‰å¤šå‘æ¨¡å¼
5. åœ¨è„šæœ¬ä¸Šæ·»åŠ  `[CreateAssetMenu]` ç‰¹æ€§

**ç¤ºä¾‹ï¼š**
```csharp
[CreateAssetMenu(menuName = "Fire Pattern/My Custom Pattern")]
public class MyFirePattern : FirePattern
{
    public override Vector2 GetFireDirection(Transform weaponTransform, int shotIndex, int totalShots, float elapsedTime)
    {
        // å®ç°ä½ çš„å‘å°„é€»è¾‘
        float angle = shotIndex * 36f; // 10ä¸ªæ–¹å‘å‡åŒ€åˆ†å¸ƒ
        return new Vector2(Mathf.Cos(angle * Mathf.Deg2Rad), Mathf.Sin(angle * Mathf.Deg2Rad));
    }
}
```

### Q7ï¼šè¿‘æˆ˜å’Œè¿œç¨‹æ­¦å™¨çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ
**Aï¼š**
- **è¿‘æˆ˜ (Melee)**ï¼šä½¿ç”¨ `OverlapCircleAll` åˆ¤å®šï¼Œå½±å“èŒƒå›´å†…çš„æ•Œäºº
- **è¿œç¨‹ (Ranged)**ï¼šå®ä¾‹åŒ–å­å¼¹ï¼Œéœ€è¦ `projectilePrefab` å’Œ `projectileSpeed`

### Q8ï¼šå¦‚ä½•è°ƒè¯•æ­¦å™¨é…ç½®ï¼Ÿ
**Aï¼š**
1. åœ¨ WeaponControl çš„ Gizmo ä¸­å¯è§†åŒ–æŸ¥çœ‹è¿‘æˆ˜åˆ¤å®šèŒƒå›´
2. é€šè¿‡ Debug.Log è¾“å‡ºå½“å‰æ­¦å™¨çŠ¶æ€ï¼ˆStateã€å°„å‡»æ•°ç­‰ï¼‰
3. ä½¿ç”¨ Inspector åœ¨è¿è¡Œæ—¶è°ƒæ•´å‚æ•°ï¼Œä½†éœ€è¦ `OnValidate()` å®æ—¶åŒæ­¥

### Q9ï¼šå†·å´å’Œè“„åŠ›çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿ
**Aï¼š**
- **å†·å´**ï¼šæŒç»­è‡ªåŠ¨å¼€ç«ç»“æŸåéœ€è¦ç­‰å¾…çš„æ—¶é—´
- **è“„åŠ›**ï¼šç©å®¶æŒ‰é”®åè¿›å…¥ Firing å‰çš„å‡†å¤‡æ—¶é—´
- ä¸¤è€…æ˜¯ç‹¬ç«‹çš„ï¼Œéƒ½å¯ä»¥é…ç½®éŸ³æ•ˆ

### Q10ï¼šèƒ½å¦è®©æ­¦å™¨æ—¢æŒç»­è‡ªåŠ¨å¼€ç«åˆæ”¯æŒè“„åŠ›ï¼Ÿ
**Aï¼š** ç›®å‰ä¸æ”¯æŒã€‚å¦‚éœ€è¿™æ ·çš„è®¾è®¡ï¼Œå¯ä»¥ï¼š
1. åˆ›å»ºæ–°çš„ FirePattern å¤„ç†è“„åŠ›é€»è¾‘
2. æˆ–ä¿®æ”¹ WeaponControl æ·»åŠ æ–°çš„çŠ¶æ€æœºåˆ†æ”¯

---

## æ€§èƒ½å»ºè®®

1. **é™åˆ¶åŒæ—¶æ´»è·ƒçš„æŒç»­è‡ªåŠ¨å¼€ç«æ­¦å™¨æ•°é‡** - æ¯ä¸ªæŒç»­å¼€ç«ä¼šåœ¨ Update ä¸­æ£€æŸ¥
2. **FirePattern ä¸­å¤æ‚è®¡ç®—åº”æ”¾åœ¨ `OnFireStart()` è€Œé `GetFireDirection()`**
3. **å¤šå‘å­å¼¹æ—¶æ³¨æ„ bulletsPerShot æ•°é‡** - è¿‡å¤šä¼šå¯¼è‡´å¸§ç‡ä¸‹é™
4. **å†·å´æ—¶é—´è‹¥æ— éœ€ä½¿ç”¨ï¼Œè®¾ä¸º 0 ä»¥èŠ‚çœè®¡æ—¶**

---

## æ›´æ–°æ—¥å¿—

- **v2.1** (2026-01-31) - ä»£ç æ¸…ç†ä¸å…¼å®¹æ€§ä¿®å¤
  - ä¿®å¤ï¼šWeaponCardControl ä½¿ç”¨ `meleeRange` æ›¿ä»£å·²åˆ é™¤çš„ `range`
  - ä¿®å¤ï¼šç§»é™¤ PropertyCard ä¸­æœªå®ç°çš„ CustomEffectType å€¼
  - ä¼˜åŒ–ï¼šç§»é™¤æœªä½¿ç”¨çš„å­—æ®µä»¥æ¶ˆé™¤ç¼–è¯‘è­¦å‘Š
  - ä¼˜åŒ–ï¼šä»£ç æ¸…ç†ï¼Œæå‡æ€§èƒ½

- **v2.0** (2026-01-31) - PropertyCard å±æ€§å¡ç³»ç»Ÿ
  - æ·»åŠ åŠ¨æ€å±æ€§ç®¡ç†ç³»ç»Ÿ
  - æ”¯æŒæš´å‡»ç³»ç»Ÿï¼ˆCritChance, CritDamageMultiplierï¼‰
  - æ–°å¢ WeaponPropertyManagerã€PlayerPropertyManagerã€EnemyPropertyManager
  - ç§»é™¤ `range` å‚æ•°ï¼Œæ”¹ç”¨ `meleeRange` ä¸“ç”¨äºè¿‘æˆ˜
  - WeaponControl æ”¯æŒé€šè¿‡ PropertyManager åŠ¨æ€è·å–å±æ€§

- **v1.0** (2026-01-31) - åˆå§‹æ­¦å™¨ç³»ç»Ÿæ–‡æ¡£
  - æ”¯æŒä¸‰ç§æ”»å‡»æ¨¡å¼
  - äº”ç§å†…ç½® FirePattern
  - å¤šå‘åŒæ—¶å‘å°„åŠŸèƒ½

---

## é‡è¦å˜æ›´è¯´æ˜

### âš ï¸ ä»æ—§ç‰ˆæœ¬å‡çº§æ³¨æ„äº‹é¡¹

#### 1. `range` å±æ€§å·²é‡å‘½åä¸º `meleeRange`

**å½±å“**ï¼šæ‰€æœ‰å¼•ç”¨ `Weapon.range` çš„ä»£ç éœ€è¦æ›´æ–°

**æ—§ä»£ç **ï¼š
```csharp
float attackRange = weapon.range;
```

**æ–°ä»£ç **ï¼š
```csharp
float attackRange = weapon.meleeRange;
```

**UI ç»‘å®šæ›´æ–°**ï¼š
```csharp
// æ—§çš„å¡ç‰‡æ˜¾ç¤ºä»£ç 
if (range != null) range.text = weapon_data.range.ToString("F1");

// æ–°çš„å¡ç‰‡æ˜¾ç¤ºä»£ç 
if (range != null) range.text = weapon_data.meleeRange.ToString("F1");
```

#### 2. `attackSpeed` å‚æ•°å·²ç§»é™¤

å·²ç»Ÿä¸€ä½¿ç”¨ `attackRate`ï¼ˆæ¯ç§’æ”»å‡»æ¬¡æ•°ï¼‰

**æ—§ä»£ç **ï¼š
```csharp
float speed = weapon.attackSpeed; // å·²åˆ é™¤
```

**æ–°ä»£ç **ï¼š
```csharp
float rate = weapon.attackRate; // ä½¿ç”¨è¿™ä¸ª
```

#### 3. `useCooldown` å‚æ•°å·²ç§»é™¤

ç›´æ¥ä½¿ç”¨ `cooldown = 0` è¡¨ç¤ºæ— å†·å´

**æ—§ä»£ç **ï¼š
```csharp
weapon.useCooldown = false;
weapon.cooldown = 5f; // è¢«å¿½ç•¥
```

**æ–°ä»£ç **ï¼š
```csharp
weapon.cooldown = 0f; // ç›´æ¥è®¾ä¸º0è¡¨ç¤ºæ— å†·å´
```

#### 4. CustomEffectType æš‚æ—¶åªæœ‰ None

è‡ªå®šä¹‰æ•ˆæœç­‰å¾…åç»­æ‰©å±•

**å½“å‰å¯ç”¨å€¼**ï¼š
- `CustomEffectType.None` - æ— è‡ªå®šä¹‰æ•ˆæœ

**æœªæ¥æ‰©å±•**ï¼šéœ€è¦æ—¶åœ¨ `CustomEffectType.cs` ä¸­æ·»åŠ æ–°å€¼

---

# å±æ€§å¡ç³»ç»Ÿ (PropertyCard System)

## æ¦‚è¿°

å±æ€§å¡ç³»ç»ŸåŸºäº **EasyPack.GamePropertySystem** å®ç°ï¼Œå…è®¸é€šè¿‡ **PropertyCard** ScriptableObject åŠ¨æ€ä¿®æ”¹æ­¦å™¨ã€ç©å®¶å’Œæ•Œäººçš„å±æ€§ã€‚ç³»ç»Ÿæ”¯æŒå¤šç§ä¿®é¥°ç¬¦ç±»å‹ï¼ˆAddã€Mulã€PriorityAdd ç­‰ï¼‰ï¼Œå¹¶æ”¯æŒå¤šå¼ å¡ç‰‡å åŠ ã€‚

### æ ¸å¿ƒç»„ä»¶

- **PropertyCard** - ScriptableObjectï¼Œå®šä¹‰ä¸€å¼ å±æ€§å¡çš„æ‰€æœ‰ä¿®é¥°ç¬¦
- **PropertyModifierElement** - å•ä¸ªä¿®é¥°ç¬¦é…ç½®ï¼ˆå±æ€§ç±»å‹ã€ä¿®é¥°ç¬¦ç±»å‹ã€æ•°å€¼ã€ä¼˜å…ˆçº§ï¼‰
- **WeaponPropertyManager** - æ­¦å™¨å±æ€§ç®¡ç†å™¨ï¼Œç®¡ç†æ­¦å™¨çš„åŠ¨æ€å±æ€§
- **PlayerPropertyManager** - ç©å®¶å±æ€§ç®¡ç†å™¨ï¼Œç®¡ç†ç©å®¶ç§»åŠ¨é€Ÿåº¦ã€ç”Ÿå‘½å€¼
- **EnemyPropertyManager** - æ•Œäººå±æ€§ç®¡ç†å™¨ï¼ˆå•ä¾‹ï¼‰ï¼Œç®¡ç†å…¨å±€æ•Œäººå±æ€§

---

## PropertyCard å±æ€§

### åŸºç¡€ä¿¡æ¯

| å±æ€§å | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `cardName` | string | å¡ç‰‡åç§° |
| `description` | string | å¡ç‰‡æè¿° |
| `cardIcon` | Sprite | å¡ç‰‡å›¾æ ‡ |
| `rarity` | CardRarity | ç¨€æœ‰åº¦ï¼ˆCommon/Rare/Epic/Legendaryï¼‰ |

### ä¿®é¥°ç¬¦åˆ—è¡¨

| å±æ€§å | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `modifiers` | List<PropertyModifierElement> | ä¿®é¥°ç¬¦åˆ—è¡¨ï¼Œå¯åŒ…å«å¤šä¸ªä¿®é¥°ç¬¦ |

æ¯ä¸ª **PropertyModifierElement** åŒ…å«ï¼š
- `targetProperty` - ç›®æ ‡å±æ€§ç±»å‹ï¼ˆPropertyType æšä¸¾ï¼‰
- `modifierType` - ä¿®é¥°ç¬¦ç±»å‹ï¼ˆModifierType æšä¸¾ï¼‰
- `value` - ä¿®é¥°ç¬¦æ•°å€¼
- `priority` - ä¼˜å…ˆçº§ï¼ˆå½±å“è®¡ç®—é¡ºåºï¼‰

### ç‰¹æ®Šæ•ˆæœï¼ˆå¯é€‰ï¼‰

| å±æ€§å | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `hasCustomEffect` | bool | æ˜¯å¦åŒ…å«è‡ªå®šä¹‰æ•ˆæœ |
| `customEffectType` | CustomEffectType | è‡ªå®šä¹‰æ•ˆæœç±»å‹ |
| `customEffectValue` | float | è‡ªå®šä¹‰æ•ˆæœæ•°å€¼ |

---

## æ”¯æŒçš„å±æ€§ç±»å‹ (PropertyType)

### æ­¦å™¨å±æ€§ï¼ˆ100~199ï¼‰

| å±æ€§ | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `Cooldown` (100) | å†·å´æ—¶é—´ | 0.5f |
| `AttackRate` (101) | æ”»å‡»é€Ÿç‡ | 1f |
| `Damage` (102) | åŸºç¡€ä¼¤å®³ | 10 |
| `ChargingTime` (103) | è“„åŠ›æ—¶é—´ | 0.2f |
| `ContinuousFireDuration` (104) | æŒç»­å¼€ç«æ—¶é—´ | 5f |
| `CritChance` (105) | æš´å‡»ç‡ï¼ˆ0~1ï¼‰ | 0f |
| `CritDamageMultiplier` (106) | æš´å‡»ä¼¤å®³å€ç‡ | 1.5f |
| `MeleeAttackRange` (107) | è¿‘æˆ˜æ”»å‡»èŒƒå›´ | 2f |

### ç©å®¶å±æ€§ï¼ˆ200~299ï¼‰

| å±æ€§ | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `PlayerMoveSpeed` (200) | ç§»åŠ¨é€Ÿåº¦ | 5f |
| `PlayerHealth` (201) | å½“å‰ç”Ÿå‘½å€¼ | 100f |
| `PlayerMaxHealth` (202) | æœ€å¤§ç”Ÿå‘½å€¼ | 100f |

### æ•Œäººå±æ€§ï¼ˆ300~399ï¼‰

| å±æ€§ | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `SmallEnemyMoveSpeed` (300) | å°å‹æ•Œäººç§»åŠ¨é€Ÿåº¦ | 2f |
| `MediumEnemyMoveSpeed` (301) | ä¸­å‹æ•Œäººç§»åŠ¨é€Ÿåº¦ | 1.5f |

---

## ä¿®é¥°ç¬¦ç±»å‹ (ModifierType)

ä¿®é¥°ç¬¦æŒ‰ä»¥ä¸‹é¡ºåºè®¡ç®—ï¼š

1. **Add** - ç›´æ¥åŠ æ³•ï¼ˆpriority = 0ï¼‰
2. **PriorityAdd** - ä¼˜å…ˆåŠ æ³•ï¼ˆpriority > 0ï¼‰
3. **Mul** - ä¹˜æ³•ï¼ˆpriority = 0ï¼‰
4. **PriorityMul** - ä¼˜å…ˆä¹˜æ³•ï¼ˆpriority > 0ï¼‰
5. **AfterAdd** - åæœŸåŠ æ³•ï¼ˆpriority ä»»æ„ï¼‰
6. **Override** - è¦†ç›–å€¼ï¼ˆpriority ä»»æ„ï¼‰
7. **Clamp** - é™åˆ¶èŒƒå›´ï¼ˆpriority ä»»æ„ï¼‰

### è®¡ç®—ç¤ºä¾‹

å‡è®¾åŸºç¡€ä¼¤å®³ = 10ï¼š

```csharp
// å¡ç‰‡ Aï¼š+5 ä¼¤å®³ (Add)
// å¡ç‰‡ Bï¼šx1.5 ä¼¤å®³ (Mul)
// å¡ç‰‡ Cï¼š+10 ä¼¤å®³ (AfterAdd)
// æœ€ç»ˆè®¡ç®—ï¼š((10 + 5) * 1.5) + 10 = 32.5

// å¦‚æœä½¿ç”¨ Overrideï¼š
// å¡ç‰‡ Dï¼š=100 ä¼¤å®³ (Override, priority=99)
// æœ€ç»ˆç»“æœï¼š100ï¼ˆå¿½ç•¥æ‰€æœ‰å…¶ä»–ä¿®é¥°ç¬¦ï¼‰
```

---

## åˆ›å»ºå±æ€§å¡

### æ–¹æ³•ä¸€ï¼šé€šè¿‡ Unity Inspector

1. åœ¨ Project çª—å£å³é”® â†’ Create â†’ Y_Survivor â†’ Property Card
2. å¡«å†™å¡ç‰‡åç§°ã€æè¿°ã€å›¾æ ‡ã€ç¨€æœ‰åº¦
3. åœ¨ Modifiers åˆ—è¡¨ä¸­æ·»åŠ ä¿®é¥°ç¬¦ï¼š
   - é€‰æ‹© Target Propertyï¼ˆå¦‚ Damageï¼‰
   - é€‰æ‹© Modifier Typeï¼ˆå¦‚ Addï¼‰
   - å¡«å†™ Valueï¼ˆå¦‚ 5ï¼‰
   - è®¾ç½® Priorityï¼ˆé€šå¸¸ä¸º 0ï¼‰

### æ–¹æ³•äºŒï¼šé€šè¿‡è„šæœ¬åˆ›å»º

```csharp
PropertyCard card = ScriptableObject.CreateInstance<PropertyCard>();
card.cardName = "ç«åŠ›å¼ºåŒ–";
card.description = "å¢åŠ  5 ç‚¹ä¼¤å®³";
card.rarity = CardRarity.Common;

// æ·»åŠ ä¿®é¥°ç¬¦
var modifier = new PropertyModifierElement
{
    targetProperty = PropertyType.Damage,
    modifierType = ModifierType.Add,
    value = 5f,
    priority = 0
};
card.modifiers.Add(modifier);

// ä¿å­˜ä¸ºèµ„æºï¼ˆç¼–è¾‘å™¨æ¨¡å¼ï¼‰
AssetDatabase.CreateAsset(card, "Assets/Data/PropertyCards/FirePowerUp.asset");
```

---

## ä½¿ç”¨å±æ€§å¡

### åœ¨ WeaponControl ä¸­åº”ç”¨å¡ç‰‡

```csharp
public class WeaponControl : MonoBehaviour
{
    public WeaponPropertyManager propertyManager;
    
    void ApplyCard(PropertyCard card)
    {
        if (propertyManager != null)
        {
            propertyManager.ApplyPropertyCard(card);
            Debug.Log($"Applied card: {card.cardName}");
        }
    }
    
    void RemoveCard(PropertyCard card)
    {
        if (propertyManager != null)
        {
            propertyManager.RemovePropertyCard(card);
        }
    }
}
```

### è¯»å–åŠ¨æ€å±æ€§å€¼

WeaponControl å·²ç»å†…ç½®äº†åŠ¨æ€å±æ€§è·å–æ–¹æ³•ï¼š

```csharp
// WeaponControl å†…éƒ¨è‡ªåŠ¨ä½¿ç”¨åŠ¨æ€å±æ€§
private int GetEffectiveDamage()
{
    if (propertyManager != null)
        return propertyManager.GetDamage();
    return weaponData.damage; // å›é€€åˆ°é™æ€å€¼
}

// å¤–éƒ¨ä¹Ÿå¯ä»¥ç›´æ¥è®¿é—®
float finalDamage = weaponControl.propertyManager.GetDamage();
float finalAttackRate = weaponControl.propertyManager.GetAttackRate();
```

### åœ¨ PlayerControl ä¸­åº”ç”¨å¡ç‰‡

```csharp
public class PlayerControl : MonoBehaviour
{
    public PlayerPropertyManager propertyManager;
    
    void Update()
    {
        // ä½¿ç”¨åŠ¨æ€ç§»åŠ¨é€Ÿåº¦
        float moveSpeed = propertyManager.GetMoveSpeed();
        transform.Translate(inputDirection * moveSpeed * Time.deltaTime);
    }
    
    void ApplyHealthCard(PropertyCard card)
    {
        propertyManager.ApplyPropertyCard(card);
    }
}
```

---

## æš´å‡»ç³»ç»Ÿ

### å·¥ä½œåŸç†

1. WeaponControl ä» WeaponPropertyManager è·å– `CritChance` å’Œ `CritDamageMultiplier`
2. åœ¨å‘å°„å­å¼¹æˆ–æ‰§è¡Œè¿‘æˆ˜æ—¶ï¼Œé€šè¿‡ `DamageDealer.Setup()` ä¼ é€’æš´å‡»å‚æ•°
3. DamageDealer åœ¨ Awake æ—¶è°ƒç”¨ `RollCritical()` è®¡ç®—æ˜¯å¦æš´å‡»
4. é€šè¿‡ `GetFinalDamage()` è¿”å›æœ€ç»ˆä¼¤å®³å€¼ï¼ˆè€ƒè™‘æš´å‡»ï¼‰

### é…ç½®ç¤ºä¾‹

åˆ›å»ºä¸€å¼  +10% æš´å‡»ç‡çš„å¡ç‰‡ï¼š

```csharp
// ä¿®é¥°ç¬¦é…ç½®
targetProperty = PropertyType.CritChance
modifierType = ModifierType.Add
value = 0.1f  // +10%
priority = 0
```

åˆ›å»ºä¸€å¼  +50% æš´å‡»ä¼¤å®³çš„å¡ç‰‡ï¼š

```csharp
// ä¿®é¥°ç¬¦é…ç½®
targetProperty = PropertyType.CritDamageMultiplier
modifierType = ModifierType.Add
value = 0.5f  // ä» 1.5x å¢åŠ åˆ° 2.0x
priority = 0
```

### DamageDealer ä½¿ç”¨

```csharp
// WeaponControl è‡ªåŠ¨å¤„ç†ï¼ˆå·²é›†æˆï¼‰
DamageDealer dd = projectile.GetComponent<DamageDealer>();
dd.Setup(
    baseDamage: GetEffectiveDamage(),
    critRate: GetEffectiveCritChance(),
    critMultiplier: GetEffectiveCritDamageMultiplier(),
    damageOwner: user
);

// DamageDealer å†…éƒ¨
void Awake()
{
    RollCritical(); // è®¡ç®—æ˜¯å¦æš´å‡»
}

void RollCritical()
{
    isCritical = Random.value < critChance;
}

int GetFinalDamage()
{
    if (isCritical)
        return Mathf.RoundToInt(damage * critDamageMultiplier);
    return damage;
}
```

---

## é…ç½®ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šæ”»å‡»é€Ÿåº¦æå‡å¡

```
Card Name: "æ€¥é€Ÿå°„å‡»"
Description: "æ”»å‡»é€Ÿç‡ +20%"
Rarity: Rare

Modifiers:
- Target Property: AttackRate
  Modifier Type: Mul
  Value: 1.2
  Priority: 0
```

**æ•ˆæœ**ï¼šåŸºç¡€æ”»å‡»é€Ÿç‡ 1.0 â†’ 1.2ï¼ˆæå‡ 20%ï¼‰

---

### ç¤ºä¾‹ 2ï¼šæš´å‡»ä¸“ç²¾å¡

```
Card Name: "è‡´å‘½æ‰“å‡»"
Description: "æš´å‡»ç‡ +15%ï¼Œæš´å‡»ä¼¤å®³ +50%"
Rarity: Epic

Modifiers:
- Target Property: CritChance
  Modifier Type: Add
  Value: 0.15
  Priority: 0
  
- Target Property: CritDamageMultiplier
  Modifier Type: Add
  Value: 0.5
  Priority: 0
```

**æ•ˆæœ**ï¼š
- æš´å‡»ç‡ï¼š0% â†’ 15%
- æš´å‡»ä¼¤å®³ï¼š1.5x â†’ 2.0x

---

### ç¤ºä¾‹ 3ï¼šå¤šé‡åŠ æˆå¡

```
Card Name: "ç»ˆæå¼ºåŒ–"
Description: "ä¼¤å®³ +10ï¼Œæ”»å‡»é€Ÿç‡ x1.3ï¼Œæš´å‡»ç‡ +10%"
Rarity: Legendary

Modifiers:
- Target Property: Damage
  Modifier Type: Add
  Value: 10
  Priority: 0
  
- Target Property: AttackRate
  Modifier Type: Mul
  Value: 1.3
  Priority: 0
  
- Target Property: CritChance
  Modifier Type: Add
  Value: 0.1
  Priority: 0
```

**æ•ˆæœ**ï¼šä¸‰é‡å±æ€§æå‡

---

### ç¤ºä¾‹ 4ï¼šç©å®¶ç§»åŠ¨é€Ÿåº¦å¡

```
Card Name: "ç–¾é£æ­¥ä¼"
Description: "ç§»åŠ¨é€Ÿåº¦ +50%"
Rarity: Common

Modifiers:
- Target Property: PlayerMoveSpeed
  Modifier Type: Mul
  Value: 1.5
  Priority: 0
```

**æ•ˆæœ**ï¼šåŸºç¡€ç§»åŠ¨é€Ÿåº¦ 5.0 â†’ 7.5

---

## é›†æˆæŒ‡å—

### åœ¨å¡ç‰‡é€‰æ‹©å™¨ä¸­åº”ç”¨

```csharp
public class PropertyCardPicker : MonoBehaviour
{
    public void OnCardSelected(PropertyCard selectedCard)
    {
        // åˆ¤æ–­å¡ç‰‡ç±»å‹å¹¶åˆ†å‘åˆ°å¯¹åº”ç®¡ç†å™¨
        foreach (var modifier in selectedCard.modifiers)
        {
            if (IsWeaponProperty(modifier.targetProperty))
            {
                // åº”ç”¨åˆ°æ­¦å™¨
                var weaponManager = FindObjectOfType<WeaponPropertyManager>();
                weaponManager.ApplyPropertyCard(selectedCard);
            }
            else if (IsPlayerProperty(modifier.targetProperty))
            {
                // åº”ç”¨åˆ°ç©å®¶
                var playerManager = FindObjectOfType<PlayerPropertyManager>();
                playerManager.ApplyPropertyCard(selectedCard);
            }
            else if (IsEnemyProperty(modifier.targetProperty))
            {
                // åº”ç”¨åˆ°æ•Œäººç³»ç»Ÿ
                EnemyPropertyManager.Instance.ApplyPropertyCard(selectedCard);
            }
        }
    }
    
    bool IsWeaponProperty(PropertyType type)
    {
        return (int)type >= 100 && (int)type < 200;
    }
    
    bool IsPlayerProperty(PropertyType type)
    {
        return (int)type >= 200 && (int)type < 300;
    }
    
    bool IsEnemyProperty(PropertyType type)
    {
        return (int)type >= 300 && (int)type < 400;
    }
}
```

---

## å¸¸è§é—®é¢˜

### Q1ï¼šå¦‚ä½•å åŠ å¤šå¼ ç›¸åŒå±æ€§çš„å¡ç‰‡ï¼Ÿ
**Aï¼š** GameProperty ç³»ç»Ÿè‡ªåŠ¨å¤„ç†å åŠ ã€‚å¤šä¸ªä¿®é¥°ç¬¦æŒ‰ä¼˜å…ˆçº§é¡ºåºä¾æ¬¡åº”ç”¨ï¼š
```
åŸºç¡€å€¼ â†’ Add â†’ PriorityAdd â†’ Mul â†’ PriorityMul â†’ AfterAdd â†’ Override
```

### Q2ï¼šç§»é™¤å¡ç‰‡åå±æ€§ä¼šæ¢å¤å—ï¼Ÿ
**Aï¼š** æ˜¯çš„ã€‚PropertyManager è·Ÿè¸ªæ¯å¼ å¡ç‰‡çš„ä¿®é¥°ç¬¦ï¼Œç§»é™¤å¡ç‰‡æ—¶ä¼šè‡ªåŠ¨ç§»é™¤å¯¹åº”çš„ä¿®é¥°ç¬¦ã€‚

### Q3ï¼šæš´å‡»ä¼¤å®³å¦‚ä½•è®¡ç®—ï¼Ÿ
**Aï¼š** 
```csharp
æœ€ç»ˆä¼¤å®³ = åŸºç¡€ä¼¤å®³ * æš´å‡»ä¼¤å®³å€ç‡ï¼ˆå¦‚æœæš´å‡»ï¼‰
         = åŸºç¡€ä¼¤å®³ï¼ˆå¦‚æœæœªæš´å‡»ï¼‰
```

### Q4ï¼šå¯ä»¥ä¿®æ”¹æ•Œäººçš„å…¨å±€å±æ€§å—ï¼Ÿ
**Aï¼š** å¯ä»¥ã€‚ä½¿ç”¨ `EnemyPropertyManager.Instance` å•ä¾‹ï¼š
```csharp
EnemyPropertyManager.Instance.ApplyPropertyCard(card);
```

### Q5ï¼šPropertyManager éœ€è¦æ‰‹åŠ¨æ·»åŠ åˆ°åœºæ™¯å—ï¼Ÿ
**Aï¼š** 
- **WeaponPropertyManager**ï¼šè‡ªåŠ¨é™„åŠ åˆ°æ­¦å™¨å¯¹è±¡ï¼ˆWeaponControl åŒå¯¹è±¡ï¼‰
- **PlayerPropertyManager**ï¼šéœ€è¦æ‰‹åŠ¨æ·»åŠ åˆ°ç©å®¶å¯¹è±¡
- **EnemyPropertyManager**ï¼šä½œä¸ºå•ä¾‹ï¼Œå¯æ”¾åœ¨ä»»æ„åœºæ™¯ç®¡ç†å™¨å¯¹è±¡ä¸Š

### Q6ï¼šå¦‚ä½•åœ¨ Inspector ä¸­æŸ¥çœ‹å½“å‰å±æ€§å€¼ï¼Ÿ
**Aï¼š** è¿è¡Œæ—¶å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æŸ¥çœ‹ï¼š
```csharp
Debug.Log($"Current Damage: {propertyManager.GetDamage()}");
Debug.Log($"Current Attack Rate: {propertyManager.GetAttackRate()}");
```

### Q7ï¼šPriority ä¼˜å…ˆçº§å¦‚ä½•å·¥ä½œï¼Ÿ
**Aï¼š** åŒç±»å‹ä¿®é¥°ç¬¦æŒ‰ priority ä»ä½åˆ°é«˜æ’åºæ‰§è¡Œã€‚ä¾‹å¦‚ï¼š
```
Add (priority=0) â†’ Add (priority=1) â†’ Add (priority=2)
```

---

## æ€§èƒ½å»ºè®®

1. **é¿å…é¢‘ç¹æ·»åŠ /ç§»é™¤å¡ç‰‡** - æ¯æ¬¡æ“ä½œéƒ½ä¼šè§¦å‘å±æ€§é‡æ–°è®¡ç®—
2. **ä½¿ç”¨ PropertyType æšä¸¾èŒƒå›´åˆ¤æ–­** - å‡å°‘å­—ç¬¦ä¸²æ¯”è¾ƒ
3. **EnemyPropertyManager å•ä¾‹é¿å…é‡å¤åˆ›å»º** - ç¡®ä¿åœºæ™¯ä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹
4. **å¤§é‡å¡ç‰‡æ—¶è€ƒè™‘ç¼“å­˜è®¡ç®—ç»“æœ** - åœ¨ PropertyManager ä¸­æ·»åŠ ç¼“å­˜æœºåˆ¶

---

## æ‰©å±•å»ºè®®

### æ·»åŠ æ–°å±æ€§ç±»å‹

1. åœ¨ `PropertyType.cs` ä¸­æ·»åŠ æšä¸¾å€¼ï¼š
```csharp
public enum PropertyType
{
    // æ­¦å™¨å±æ€§ (100~199)
    NewWeaponProperty = 108,
    
    // ç©å®¶å±æ€§ (200~299)
    NewPlayerProperty = 203,
}
```

2. åœ¨å¯¹åº”çš„ PropertyManager ä¸­æ·»åŠ  GamePropertyï¼š
```csharp
public GameProperty NewProperty { get; private set; }

void InitializeProperties()
{
    NewProperty = new GameProperty("Weapon.NewProperty", defaultValue);
}
```

3. åœ¨ `GetPropertyByType()` ä¸­æ·»åŠ æ˜ å°„ï¼š
```csharp
case PropertyType.NewWeaponProperty:
    return NewProperty;
```

### æ·»åŠ è‡ªå®šä¹‰æ•ˆæœ

åœ¨ `CustomEffectType.cs` ä¸­å®šä¹‰æ–°æ•ˆæœç±»å‹ï¼Œç„¶ååœ¨åº”ç”¨å¡ç‰‡æ—¶æ£€æŸ¥ï¼š
```csharp
if (card.hasCustomEffect)
{
    switch (card.customEffectType)
    {
        case CustomEffectType.LifeSteal:
            EnableLifeSteal(card.customEffectValue);
            break;
    }
}
```

---

## ç›¸å…³æ–‡ä»¶

- `Assets/Scripts/Y_Survivor/PropertyCard/PropertyCard.cs` - å±æ€§å¡ ScriptableObject
- `Assets/Scripts/Y_Survivor/PropertyCard/PropertyType.cs` - å±æ€§ç±»å‹æšä¸¾
- `Assets/Scripts/Y_Survivor/PropertyCard/PropertyModifierElement.cs` - ä¿®é¥°ç¬¦é…ç½®
- `Assets/Scripts/Y_Survivor/PropertyCard/WeaponPropertyManager.cs` - æ­¦å™¨å±æ€§ç®¡ç†å™¨
- `Assets/Scripts/Y_Survivor/PropertyCard/PlayerPropertyManager.cs` - ç©å®¶å±æ€§ç®¡ç†å™¨
- `Assets/Scripts/Y_Survivor/PropertyCard/EnemyPropertyManager.cs` - æ•Œäººå±æ€§ç®¡ç†å™¨
- `Assets/Scripts/Y_Survivor/WeaponControl.cs` - æ­¦å™¨æ§åˆ¶å™¨ï¼ˆå·²é›†æˆåŠ¨æ€å±æ€§ï¼‰
- `Assets/Scripts/Y_Survivor/DamageDealer.cs` - ä¼¤å®³å¤„ç†å™¨ï¼ˆå·²é›†æˆæš´å‡»ç³»ç»Ÿï¼‰
- `Assets/Scripts/Y_Survivor/doc/å±æ€§å¡ç³»ç»Ÿå®ç°è®¡åˆ’.md` - å®ç°è®¡åˆ’

